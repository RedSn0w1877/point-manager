<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRISM MANAGER | Refractive Excellence</title>
    
    <!-- 1. TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'glow-prism': 'glow-prism 2s ease-in-out infinite alternate',
                        'spin-fast': 'spin 0.5s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        'glow-prism': {
                            'from': { boxShadow: '0 0 10px -10px rgba(139, 92, 246, 0)' },
                            'to': { boxShadow: '0 0 30px 10px rgba(139, 92, 246, 0.4)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- 2. REACT CORE -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- 3. BABEL -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #020202;
            margin: 0;
            padding: 0;
            overflow: hidden;
            color: #e2e8f0;
        }

        .noise-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 50;
            opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }
        
        /* --- HIGH OCTANE CINEMATICS --- */
        @keyframes prism-implode {
            0% { transform: scale(1.5) rotate(0deg); opacity: 0; filter: blur(20px); }
            100% { transform: scale(0.1) rotate(360deg); opacity: 1; filter: blur(0px); }
        }
        @keyframes prism-boom {
            0% { transform: scale(0.5); opacity: 1; filter: brightness(5); }
            50% { transform: scale(1.2); filter: brightness(2); }
            100% { transform: scale(1); opacity: 1; filter: brightness(1); }
        }
        @keyframes shockwave-prism {
            0% { transform: scale(0); opacity: 1; border-width: 150px; }
            100% { transform: scale(3.5); opacity: 0; border-width: 0px; }
        }
        @keyframes flash-white {
            0% { opacity: 0; }
            10% { opacity: 1; }
            100% { opacity: 0; }
        }
        @keyframes particle-fly {
            0% { transform: translate(0,0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tw-translate-x), var(--tw-translate-y)) scale(0); opacity: 0; }
        }

        .animate-prism-implode { animation: prism-implode 0.8s cubic-bezier(0.87, 0, 0.13, 1) forwards; }
        .animate-prism-boom { animation: prism-boom 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        .animate-shockwave-prism { animation: shockwave-prism 1s cubic-bezier(0.075, 0.82, 0.165, 1) forwards; }
        .animate-flash { animation: flash-white 0.6s ease-out forwards; }

        .glass-panel {
            background: rgba(8, 8, 8, 0.7);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.7);
        }
        
        .prism-gradient-text {
            background: linear-gradient(to right, #6366f1, #a855f7, #ec4899, #f43f5e, #eab308);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shine 4s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }
    </style>
</head>
<body>
    <div class="noise-overlay"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;

        const Icons = {
            LayoutDashboard: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>,
            Trophy: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            CheckSquare: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 11 3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>,
            Book: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>,
            Shield: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>,
            Zap: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Crown: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
            Flame: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>,
            Sparkles: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M3 5h4"/><path d="M3 9h4"/></svg>,
            Smartphone: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>,
            Calendar: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Star: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            RefreshCw: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            User: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
            Trash2: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>,
            Plus: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Minus: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/></svg>,
            X: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Info: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>,
            ArrowUpRight: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>,
            Coins: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/><path d="M7 6h1v4"/><path d="m16.71 13.88.7 .71-2.82 2.82"/></svg>,
            Hexagon: (p) => <svg {...p} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>,
        };

        const TIERS = [
            { name: 'Bronze', min: 0, max: 120, value: '$0-$5', color: 'from-orange-800 to-orange-600', textColor: 'text-orange-500', icon: Icons.Shield },
            { name: 'Silver', min: 120, max: 300, value: '$5-$20', color: 'from-slate-400 to-slate-200', textColor: 'text-slate-300', icon: Icons.Shield },
            { name: 'Gold', min: 300, max: 600, value: '$20-$50', color: 'from-yellow-600 to-yellow-300', textColor: 'text-yellow-400', icon: Icons.Trophy },
            { name: 'Platinum', min: 600, max: 950, value: '$50-$100', color: 'from-cyan-600 to-cyan-300', textColor: 'text-cyan-400', icon: Icons.Trophy },
            { name: 'Titanium', min: 950, max: 1400, value: '$100-$200', color: 'from-slate-600 to-slate-400', textColor: 'text-slate-200', icon: Icons.Shield },
            { name: 'Palladium', min: 1400, max: 1900, value: '$200-$350', color: 'from-orange-400 to-yellow-200', textColor: 'text-orange-200', icon: Icons.Zap },
            { name: 'Iridium', min: 1900, max: 2500, value: '$350-$600', color: 'from-indigo-600 to-purple-400', textColor: 'text-indigo-300', icon: Icons.Zap },
            { name: 'Obsidian', min: 2500, max: 3200, value: '$600-$900', color: 'from-neutral-900 to-neutral-700', textColor: 'text-neutral-400', icon: Icons.Crown },
            { name: 'Carbon', min: 3200, max: 4000, value: '$900-$1.2k', color: 'from-zinc-800 to-zinc-600', textColor: 'text-zinc-400', icon: Icons.Shield },
            { name: 'Emerald', min: 4000, max: 4900, value: '$1.2k-$1.5k', color: 'from-emerald-700 to-emerald-400', textColor: 'text-emerald-400', icon: Icons.Crown },
            { name: 'Sapphire', min: 4900, max: 6000, value: '$1.5k-$2k', color: 'from-blue-800 to-blue-500', textColor: 'text-blue-400', icon: Icons.Crown },
            { name: 'Amethyst', min: 6000, max: 7200, value: '$2k+', color: 'from-purple-800 to-fuchsia-500', textColor: 'text-fuchsia-400', icon: Icons.Crown },
            { name: 'Ruby', min: 7200, max: 8600, value: '∞', color: 'from-rose-800 to-rose-500', textColor: 'text-rose-400', icon: Icons.Flame },
            { name: 'Diamond', min: 8600, max: 100000, value: '∞', color: 'from-cyan-200 via-white to-blue-200', textColor: 'text-cyan-100', icon: Icons.Sparkles },
        ];

        const useLocalStorage = (key, initialValue) => {
            const [storedValue, setStoredValue] = useState(() => {
                try { return JSON.parse(window.localStorage.getItem(key)) || initialValue; } 
                catch { return initialValue; }
            });
            const setValue = (value) => {
                try {
                    const valueToStore = value instanceof Function ? value(storedValue) : value;
                    setStoredValue(valueToStore);
                    window.localStorage.setItem(key, JSON.stringify(valueToStore));
                } catch (e) { console.error(e); }
            };
            return [storedValue, setValue];
        };

        const StarryBackground = () => {
            const canvasRef = useRef(null);
            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                canvas.style.position = 'fixed';
                canvas.style.top = '0'; canvas.style.left = '0';
                canvas.style.width = '100vw'; canvas.style.height = '100vh';
                canvas.style.zIndex = '0';
                
                const stars = Array.from({length: 180}).map(() => ({
                    x: Math.random() * window.innerWidth,
                    y: Math.random() * window.innerHeight,
                    size: Math.random() * 2,
                    speed: Math.random() * 0.1,
                    opacity: Math.random(),
                    hue: Math.random() * 360
                }));

                const animate = () => {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                    ctx.fillStyle = '#020202';
                    ctx.fillRect(0,0,canvas.width, canvas.height);
                    
                    const time = Date.now() * 0.0003;
                    
                    // Prismatic Aurora Swirls
                    const g1 = ctx.createRadialGradient(
                        canvas.width * 0.5 + Math.sin(time) * 200, 
                        canvas.height * 0.5 + Math.cos(time * 0.5) * 100, 
                        0, 
                        canvas.width * 0.5, 
                        canvas.height * 0.5, 
                        canvas.width * 0.8
                    );
                    g1.addColorStop(0, 'rgba(124, 58, 237, 0.06)'); // Violet
                    g1.addColorStop(0.5, 'rgba(30, 64, 175, 0.03)'); // Blue
                    g1.addColorStop(1, 'transparent');
                    ctx.fillStyle = g1;
                    ctx.fillRect(0,0,canvas.width,canvas.height);

                    stars.forEach(s => {
                        s.y -= s.speed;
                        if(s.y < 0) s.y = canvas.height;
                        ctx.beginPath();
                        ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
                        ctx.fillStyle = `hsla(${s.hue}, 70%, 80%, ${s.opacity})`;
                        ctx.fill();
                    });
                    requestAnimationFrame(animate);
                };
                animate();
            }, []);
            return <canvas ref={canvasRef} />;
        };

        // --- THE BOOM ANIMATION ---
        const LevelUpCinematic = ({ oldTier, newTier, userName, onClose }) => {
            const [phase, setPhase] = useState('focus');
            const NewIcon = newTier.icon;
            
            // Random particle generator for the boom
            const particles = useMemo(() => {
                return Array.from({ length: 100 }).map((_, i) => ({
                    id: i,
                    angle: (Math.PI * 2 * i) / 100 + (Math.random() - 0.5),
                    distance: 200 + Math.random() * 600,
                    size: 2 + Math.random() * 6,
                    color: `hsl(${Math.random() * 360}, 100%, 70%)`,
                    delay: Math.random() * 0.2
                }));
            }, []);

            useEffect(() => {
                const timers = [
                    setTimeout(() => setPhase('implode'), 100),
                    setTimeout(() => setPhase('boom'), 1100),
                    setTimeout(() => setPhase('reveal'), 1300),
                ];
                return () => timers.forEach(clearTimeout);
            }, []);

            return (
                <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 overflow-hidden">
                    {/* Background Flash */}
                    {phase === 'boom' && <div className="absolute inset-0 bg-white z-[110] animate-flash"></div>}
                    
                    {/* Shockwaves */}
                    {phase === 'boom' && (
                        <>
                            <div className="absolute w-[200vw] h-[200vw] rounded-full border-[80px] border-white opacity-0 animate-shockwave-prism"></div>
                            <div className={`absolute w-[180vw] h-[180vw] rounded-full border-[40px] border-indigo-400 opacity-0 animate-shockwave-prism`} style={{ animationDelay: '0.1s' }}></div>
                            <div className={`absolute w-[160vw] h-[160vw] rounded-full border-[20px] border-purple-500 opacity-0 animate-shockwave-prism`} style={{ animationDelay: '0.2s' }}></div>
                        </>
                    )}

                    {/* Exploding Particles */}
                    {phase === 'boom' && particles.map(p => (
                        <div key={p.id} className="absolute rounded-full"
                            style={{
                                width: p.size, height: p.size,
                                backgroundColor: p.color,
                                left: '50%', top: '50%',
                                '--tw-translate-x': `${Math.cos(p.angle) * p.distance}px`,
                                '--tw-translate-y': `${Math.sin(p.angle) * p.distance}px`,
                                animation: `particle-fly 1.5s cubic-bezier(0.1, 0.8, 0.2, 1) forwards`,
                                animationDelay: `${p.delay}s`
                            }}
                        />
                    ))}

                    <div className="relative flex flex-col items-center justify-center">
                        {/* Imploding stage */}
                        {phase === 'implode' && (
                            <div className="animate-prism-implode flex flex-col items-center">
                                <div className={`w-32 h-32 rounded-3xl bg-gradient-to-br ${oldTier.color} glass-panel flex items-center justify-center shadow-2xl`}>
                                    {React.createElement(oldTier.icon, { size: 64, className: "text-white" })}
                                </div>
                            </div>
                        )}

                        {/* Reveal stage */}
                        {(phase === 'boom' || phase === 'reveal') && (
                            <div className="flex flex-col items-center animate-prism-boom z-[120]">
                                <div className={`w-56 h-56 rounded-[3rem] bg-gradient-to-br ${newTier.color} flex items-center justify-center shadow-[0_0_120px_rgba(255,255,255,0.4)] mb-8 ring-8 ring-white/10 glass-panel animate-float relative`}>
                                    <div className="absolute inset-0 bg-white/20 rounded-[3rem] animate-pulse"></div>
                                    <NewIcon size={110} className="text-white drop-shadow-2xl relative z-10" />
                                </div>
                                <div className="text-center animate-fade-in" style={{ animationDelay: '0.4s' }}>
                                    <h2 className="text-2xl font-black text-indigo-400 tracking-[0.5em] uppercase mb-4 opacity-70">New Prism Attained</h2>
                                    <h1 className="text-9xl font-black text-white tracking-tighter drop-shadow-[0_0_30px_rgba(255,255,255,0.5)] mb-8 uppercase">
                                        {newTier.name}
                                    </h1>
                                    <button 
                                        onClick={onClose} 
                                        className="px-12 py-5 bg-white text-black font-black rounded-2xl text-xl hover:scale-110 active:scale-95 transition-all shadow-[0_20px_50px_rgba(255,255,255,0.3)] hover:shadow-indigo-500/50"
                                    >
                                        ASCEND
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const Dashboard = ({ users, energy, recharge }) => {
            const [time, setTime] = useState(new Date());
            const [focus, setFocus] = useLocalStorage('prism_focus', '');
            useEffect(() => { const t = setInterval(() => setTime(new Date()), 1000); return () => clearInterval(t); }, []);
            
            return (
                <div className="space-y-6 animate-fade-in relative z-10">
                    <div className="relative overflow-hidden rounded-[2.5rem] border border-white/10 p-12 shadow-2xl glass-panel group">
                        <div className="absolute inset-0 bg-gradient-to-tr from-indigo-900/40 via-purple-900/10 to-transparent opacity-60"></div>
                        <div className="relative z-10 flex flex-col md:flex-row justify-between items-end gap-8">
                            <div>
                                <h2 className="text-xs font-mono text-indigo-400 tracking-[0.5em] mb-4 flex items-center gap-3 font-black">
                                    <span className={`w-2.5 h-2.5 rounded-full ${energy > 20 ? 'bg-emerald-500 animate-pulse shadow-[0_0_15px_#10b981]' : 'bg-rose-500'}`}></span>
                                    PRISM_CORE_ACTIVE
                                </h2>
                                <h1 className="text-8xl md:text-[10rem] font-black text-white tracking-tighter drop-shadow-2xl leading-none mb-4 selection:bg-indigo-500">
                                    {time.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'})}
                                </h1>
                                <p className="text-slate-400 text-2xl font-light flex items-center gap-4 italic">
                                    <Icons.Calendar size={24} className="text-purple-500"/>
                                    {time.toLocaleDateString([], {weekday:'long', month:'long', day:'numeric'})}
                                </p>
                            </div>
                            <div className="hidden md:block text-right">
                                <div className="bg-black/40 backdrop-blur-xl border border-white/10 px-8 py-5 rounded-[2rem] shadow-xl">
                                    <div className="text-3xl font-black text-white flex items-center justify-end gap-4">
                                        <Icons.Smartphone size={24} className="text-indigo-400"/> Sharon, MA
                                    </div>
                                    <div className="text-sm text-slate-500 font-mono mt-2 tracking-widest uppercase">Atmospheric: CLEAR</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div className="md:col-span-2 glass-panel rounded-[2.5rem] p-10 group hover:border-indigo-500/50 transition-all">
                            <h3 className="text-slate-500 font-black uppercase text-xs mb-6 flex gap-3 tracking-[0.3em]"><Icons.Star size={16} className="text-yellow-500"/> SYSTEM_PRIORITY</h3>
                            <input value={focus} onChange={e => setFocus(e.target.value)} placeholder="What is the mission, Captain?" className="w-full bg-transparent text-5xl font-black text-white outline-none border-b-2 border-white/5 pb-6 focus:border-indigo-500 transition-all placeholder-slate-800 selection:bg-purple-500"/>
                        </div>
                        
                        <div className="glass-panel rounded-[2.5rem] p-10 relative overflow-hidden flex flex-col justify-between hover:border-emerald-500/30 transition-all">
                            <div className="flex justify-between items-center relative z-10">
                                <h3 className="text-slate-500 font-black uppercase text-xs flex gap-3 tracking-[0.3em]"><Icons.Zap size={16} className={energy > 20 ? "text-emerald-400" : "text-rose-500"}/> REFRACTION_ENERGY</h3>
                                <span className={`text-xs font-mono font-black ${energy > 20 ? 'text-emerald-500' : 'text-rose-500 animate-bounce'}`}>{energy > 20 ? 'OPTIMAL' : 'LOW'}</span>
                            </div>
                            <div className="my-8 text-8xl font-black text-white font-mono tracking-tighter drop-shadow-2xl">{Math.floor(energy)}<span className="text-2xl text-slate-700">%</span></div>
                            <button onClick={recharge} className="relative z-10 w-full glass-button text-white py-4 rounded-2xl text-xs font-black uppercase flex justify-center gap-3 tracking-[0.2em] hover:bg-white/10 active:scale-95 transition-all">
                                <Icons.RefreshCw size={18} className={energy < 100 ? "animate-spin-fast" : ""}/> Pulse System
                            </button>
                            <div className="absolute bottom-0 left-0 h-2 w-full bg-black/50">
                                <div className={`h-full transition-all duration-700 ${energy > 20 ? 'bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500' : 'bg-rose-600 animate-pulse'}`} style={{width: `${energy}%`}}></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const PointsManager = ({ users, addUser, modifyPoints, deleteUser }) => {
            const [input, setInput] = useState('');
            const [showLegend, setShowLegend] = useState(false);
            const [customAmounts, setCustomAmounts] = useState({});

            const handleCustomAmount = (userId, multiplier) => {
                const val = parseInt(customAmounts[userId]);
                if (!isNaN(val) && val > 0) {
                    modifyPoints(userId, val * multiplier);
                    setCustomAmounts(prev => ({ ...prev, [userId]: '' }));
                }
            };

            return (
                <div className="animate-fade-in space-y-10 pb-20 relative z-10">
                    <div className="flex flex-col md:flex-row justify-between items-end border-b border-white/10 pb-8 gap-6">
                        <div>
                            <h2 className="text-6xl font-black prism-gradient-text tracking-tighter mb-3 drop-shadow-2xl uppercase">PRISM POINTS</h2>
                            <p className="text-slate-500 text-sm font-black flex items-center gap-3 font-mono tracking-widest">
                                <span className="w-2.5 h-2.5 bg-indigo-500 rounded-full animate-pulse"></span> NETWORK_LATTICE_UP
                            </p>
                        </div>
                        <div className="flex gap-4">
                            <button onClick={() => setShowLegend(true)} className="glass-button text-white px-6 py-3 rounded-2xl flex items-center gap-3 text-sm font-black tracking-widest hover:bg-white/10 transition-all">
                                <Icons.Info size={20} className="text-indigo-400"/> TIERS
                            </button>
                            <form onSubmit={(e) => { e.preventDefault(); if(input) { addUser(input); setInput(''); } }} className="flex gap-2 group">
                                <input value={input} onChange={e => setInput(e.target.value)} placeholder="Identity Signature..." className="bg-black/60 border border-white/10 rounded-2xl px-6 py-3 text-white outline-none focus:border-purple-500 text-sm w-64 transition-all placeholder-slate-700 font-bold" />
                                <button className="bg-indigo-600 hover:bg-indigo-500 px-6 rounded-2xl text-black font-black transition-all active:scale-90"><Icons.Plus size={24}/></button>
                            </form>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                        {users.map(u => {
                            const safePoints = u.points || 0;
                            const tier = TIERS.find(t => safePoints >= t.min && safePoints < t.max) || TIERS[TIERS.length - 1];
                            const TierIcon = tier.icon;
                            const nextTier = TIERS[TIERS.indexOf(tier) + 1];
                            let progress = 100;
                            if (nextTier) {
                                progress = ((safePoints - tier.min) / (nextTier.min - tier.min)) * 100;
                            }

                            return (
                                <div key={u.id} className="group relative transition-all hover:-translate-y-3">
                                    <div className={`absolute -inset-1 bg-gradient-to-br ${tier.color} rounded-[2rem] opacity-20 group-hover:opacity-100 blur-xl transition duration-700`}></div>
                                    
                                    <div className="relative glass-panel rounded-[2rem] p-8 h-full flex flex-col justify-between overflow-hidden">
                                        <div className={`absolute -right-16 -top-16 w-56 h-56 bg-gradient-to-br ${tier.color} opacity-10 blur-[60px] rounded-full`}></div>
                                        
                                        <div>
                                            <div className="flex justify-between items-start mb-8 relative z-10">
                                                <div className="flex items-center gap-5">
                                                    <div className={`w-16 h-16 rounded-[1.25rem] bg-gradient-to-br ${tier.color} flex items-center justify-center shadow-2xl group-hover:rotate-12 transition-transform duration-500`}>
                                                        <TierIcon size={32} className="text-white drop-shadow-lg" />
                                                    </div>
                                                    <div>
                                                        <h3 className="font-black text-white text-2xl tracking-tighter mb-1 uppercase selection:bg-indigo-500">{u.name}</h3>
                                                        <span className={`text-xs font-black uppercase tracking-[0.3em] ${tier.textColor}`}>{tier.name}</span>
                                                    </div>
                                                </div>
                                                <button onClick={() => deleteUser(u.id)} className="text-slate-700 hover:text-rose-500 transition-all p-2 hover:bg-rose-500/10 rounded-xl"><Icons.Trash2 size={20}/></button>
                                            </div>

                                            <div className="mb-8 relative z-10">
                                                <div className="flex justify-between text-[11px] text-slate-500 mb-3 font-mono font-black uppercase tracking-widest">
                                                    <span>{safePoints.toLocaleString()} ENERGY</span>
                                                    <span className={progress >= 100 ? 'text-emerald-500' : 'text-purple-500'}>{nextTier ? 'Evolution' : 'Apex'}</span>
                                                </div>
                                                <div className="relative h-4 bg-black/80 rounded-full overflow-hidden border border-white/5 shadow-inner p-0.5">
                                                    <div className={`absolute top-0 left-0 h-full bg-gradient-to-r ${tier.color} transition-all duration-1000 ease-out`} style={{ width: `${progress}%` }}>
                                                        <div className="absolute inset-0 bg-white/20 animate-pulse"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="space-y-4 relative z-10 border-t border-white/10 pt-6">
                                            <div className="flex gap-3">
                                                <button onClick={() => modifyPoints(u.id, 100)} className="flex-1 glass-button text-emerald-500 py-3 rounded-2xl text-xs font-black uppercase tracking-widest hover:bg-emerald-500/10">+100</button>
                                                <button onClick={() => modifyPoints(u.id, -100)} className="flex-1 glass-button text-rose-500 py-3 rounded-2xl text-xs font-black uppercase tracking-widest hover:bg-rose-500/10">-100</button>
                                            </div>
                                            
                                            <div className="flex gap-2">
                                                <input 
                                                    type="number" 
                                                    placeholder="Quantum Shift..."
                                                    value={customAmounts[u.id] || ''}
                                                    onChange={(e) => setCustomAmounts({...customAmounts, [u.id]: e.target.value})}
                                                    className="flex-1 bg-black/60 border border-white/10 rounded-2xl px-4 py-3 text-xs text-white outline-none focus:border-indigo-500 font-bold"
                                                />
                                                <button onClick={() => handleCustomAmount(u.id, 1)} className="glass-button text-emerald-400 px-4 rounded-2xl hover:bg-emerald-500/20"><Icons.Plus size={18}/></button>
                                                <button onClick={() => handleCustomAmount(u.id, -1)} className="glass-button text-rose-400 px-4 rounded-2xl hover:bg-rose-500/20"><Icons.Minus size={18}/></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    {showLegend && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/95 backdrop-blur-2xl animate-fade-in" onClick={() => setShowLegend(false)}>
                            <div className="glass-panel w-full max-w-2xl rounded-[3rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] scale-100" onClick={e => e.stopPropagation()}>
                                <div className="p-8 border-b border-white/10 flex justify-between items-center bg-white/5">
                                    <h3 className="text-3xl font-black text-white flex gap-4 items-center uppercase tracking-tighter"><Icons.ArrowUpRight size={32} className="text-indigo-500"/> Prism Hierarchy</h3>
                                    <button onClick={() => setShowLegend(false)} className="text-slate-400 hover:text-white p-3 hover:bg-white/10 rounded-2xl transition-all"><Icons.X size={28}/></button>
                                </div>
                                <div className="p-8 space-y-4 max-h-[70vh] overflow-y-auto custom-scrollbar">
                                    {TIERS.map(t => (
                                        <div key={t.name} className="flex items-center gap-6 p-6 rounded-3xl bg-white/5 border border-white/5 hover:border-white/20 transition-all hover:translate-x-2">
                                            <div className={`w-14 h-14 rounded-2xl bg-gradient-to-br ${t.color} flex items-center justify-center shadow-xl`}>
                                                {React.createElement(t.icon, { size: 28, className: "text-white" })}
                                            </div>
                                            <div className="flex-1">
                                                <div className="flex justify-between items-center mb-1">
                                                    <span className={`font-black text-2xl uppercase tracking-tighter ${t.textColor}`}>{t.name}</span>
                                                    <span className="text-xs text-slate-500 font-mono font-bold bg-black/40 px-3 py-1 rounded-lg">{t.value}</span>
                                                </div>
                                                <div className="text-xs text-slate-500 font-mono font-bold tracking-widest">{t.min.toLocaleString()} - {t.max.toLocaleString()} ENERGY</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const PrismManager = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [users, setUsers] = useLocalStorage('prism_loyalty', [{ id: 1, name: 'Lead Specialist', points: 420 }]);
            const [tasks, setTasks] = useLocalStorage('prism_quests', []);
            const [energy, setEnergy] = useState(100);
            const [cinematicData, setCinematicData] = useState(null);
            const prevRanksRef = useRef({});

            useEffect(() => {
                const interval = setInterval(() => setEnergy(p => Math.max(0, p - 0.5)), 4000);
                return () => clearInterval(interval);
            }, []);

            useEffect(() => {
                users.forEach(user => {
                    const currentTier = TIERS.find(t => user.points >= t.min && user.points < t.max) || TIERS[TIERS.length - 1];
                    const prevTierName = prevRanksRef.current[user.id];
                    if (prevTierName && prevTierName !== currentTier.name) {
                        const prevIndex = TIERS.findIndex(t => t.name === prevTierName);
                        const currIndex = TIERS.findIndex(t => t.name === currentTier.name);
                        if (currIndex > prevIndex) {
                            setCinematicData({ user, oldTier: TIERS[prevIndex], newTier: currentTier });
                        }
                    }
                    prevRanksRef.current[user.id] = currentTier.name;
                });
            }, [users]);

            const modifyPoints = (id, amt) => setUsers(users.map(u => u.id === id ? { ...u, points: Math.max(0, u.points + amt) } : u));
            const addUser = (name) => setUsers([...users, { id: Date.now(), name, points: 0 }]);
            const deleteUser = (id) => setUsers(users.filter(u => u.id !== id));

            const TABS = [
                { id: 'dashboard', label: 'Command Deck', icon: Icons.LayoutDashboard },
                { id: 'grind', label: 'Prism Points', icon: Icons.Trophy },
                { id: 'quests', label: 'Mission Log', icon: Icons.CheckSquare },
                { id: 'neural', label: 'Data Core', icon: Icons.Book },
            ];

            return (
                <div className="flex h-screen w-full relative overflow-hidden font-sans">
                    <StarryBackground />
                    
                    {/* SIDEBAR */}
                    <div className="w-24 md:w-80 bg-[#050505]/90 border-r border-white/5 flex flex-col p-8 z-20 backdrop-blur-3xl">
                        <div className="flex items-center gap-5 mb-16 px-2">
                            <div className="w-14 h-14 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-600 rounded-[1.25rem] flex items-center justify-center shrink-0 shadow-[0_0_40px_rgba(99,102,241,0.5)] animate-float">
                                <Icons.Hexagon className="text-white" size={32}/>
                            </div>
                            <div className="hidden md:block">
                                <h1 className="font-black text-3xl text-white tracking-tighter leading-none">PRISM</h1>
                                <p className="text-[10px] text-slate-500 font-mono tracking-[0.5em] uppercase mt-1">Manager v1.0</p>
                            </div>
                        </div>
                        <nav className="space-y-4 flex-1">
                            {TABS.map(t => (
                                <button key={t.id} onClick={() => setActiveTab(t.id)} className={`w-full flex items-center gap-5 px-6 py-5 rounded-2xl transition-all duration-300 group relative ${activeTab === t.id ? 'text-white bg-white/5 shadow-2xl border border-white/10' : 'text-slate-500 hover:text-white hover:bg-white/5'}`}>
                                    {activeTab === t.id && <div className="absolute left-0 top-1/4 bottom-1/4 w-1 bg-indigo-500 rounded-full shadow-[0_0_20px_#6366f1]"></div>}
                                    <t.icon size={26} className={`transition-transform group-hover:scale-110 ${activeTab === t.id ? 'text-indigo-400 drop-shadow-[0_0_10px_rgba(99,102,241,0.8)]' : ''}`}/>
                                    <span className="hidden md:block font-black text-sm uppercase tracking-widest">{t.label}</span>
                                </button>
                            ))}
                        </nav>
                        <div className="pt-10 border-t border-white/10">
                            <div className="glass-panel rounded-3xl p-4 flex items-center gap-5 cursor-pointer hover:bg-white/10 transition-all">
                                <div className="w-12 h-12 rounded-2xl bg-slate-900 flex items-center justify-center border border-white/10 shadow-inner"><Icons.User size={24} className="text-slate-500"/></div>
                                <div className="hidden md:block">
                                    <p className="text-sm font-black text-white uppercase tracking-tighter">Director</p>
                                    <p className="text-[10px] text-emerald-500 font-mono font-black uppercase tracking-widest flex items-center gap-2"><span className="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span> Synchronized</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="flex-1 p-8 md:p-16 overflow-y-auto relative z-10 custom-scrollbar">
                        <div className="max-w-7xl mx-auto">
                            {activeTab === 'dashboard' && <Dashboard users={users} energy={energy} recharge={() => setEnergy(100)} />}
                            {activeTab === 'grind' && <PointsManager users={users} addUser={addUser} modifyPoints={modifyPoints} deleteUser={deleteUser} />}
                            {/* Simple placeholders for other tabs to keep focus on animation */}
                            {activeTab === 'quests' && (
                                <div className="h-full flex flex-col items-center justify-center text-slate-800 animate-pulse">
                                    <Icons.CheckSquare size={120}/>
                                    <p className="font-black text-4xl uppercase mt-8 tracking-widest">Awaiting Missions</p>
                                </div>
                            )}
                            {activeTab === 'neural' && (
                                <div className="h-full flex flex-col items-center justify-center text-slate-800 animate-pulse">
                                    <Icons.Book size={120}/>
                                    <p className="font-black text-4xl uppercase mt-8 tracking-widest">Vault Encrypted</p>
                                </div>
                            )}
                        </div>
                    </div>

                    {cinematicData && (
                        <LevelUpCinematic 
                            oldTier={cinematicData.oldTier} 
                            newTier={cinematicData.newTier} 
                            userName={cinematicData.user.name} 
                            onClose={() => setCinematicData(null)} 
                        />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PrismManager />);
    </script>
</body>
</html>
